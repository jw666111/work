# 优云智算套餐包产品需求文档（PRD）

## 文档信息

| 项目 | 内容 |
|------|------|
| 产品名称 | 优云智算套餐包/订阅包 |
| 版本 | V1.1 |
| 创建日期 | 2026-02-03 |
| 状态 | 草稿 |

---

## 1. 产品概述

### 1.1 背景

优云智算主要面向C端客户。根据124优云的收入数据分析，用户具有明显的**价格敏感性**特征，对原价API更多是尝试性使用。

为跟进 moltbot（clawdbot）热点，计划推出**套餐包/资源包/订阅包**产品，帮助用户能够更快上手使用，降低使用门槛，提升付费转化率。

### 1.2 产品目标

1. 降低用户使用门槛，提供更具性价比的计费方式
2. 提升用户付费转化率和留存率
3. 增加用户粘性，建立稳定的收入来源
4. 跟进市场热点，抢占 Clawdbot 用户群体

### 1.3 目标用户

- **主要用户**：C端个人用户
- **用户特征**：价格敏感型，追求性价比
- **使用场景**：AI API调用、模型使用

---

## 2. 套餐类型定义

### 2.1 套餐分档

套餐分为三大类：**体验包**、**包月**、**按量**

| 套餐分档 | 套餐类型 | 说明 | 有效期 | 数量限制 |
|----------|----------|------|--------|----------|
| **体验包** | 按量 | 新用户入门体验，小额尝试 | 1年 | 限购1个 |
| **包月** | 订阅 | 按月订阅，固定时长内享受额度 | 30天/月 | 可叠加购买 |
| **按量** | 资源包 | 一次性购买，用完即止 | 1年 | 最多10个 |

### 2.2 首期上线套餐

#### 2.2.1 体验包
- **体验套餐**：新用户入门包（价格待定）

#### 2.2.2 按量套餐
- **大套餐**：大额套餐包（价格待定）

#### 2.2.3 包月套餐
- **畅享包月**：99元/月（首期仅上线此档位）

---

## 3. 核心业务规则

### 3.1 扣费优先级

```
包月套餐 > 按量套餐包 > 原价API（开关控制）
```

**规则说明**：
1. 优先扣除包月套餐额度
2. 包月额度用尽后，扣除按量套餐包
3. 按量套餐包用尽后，根据用户设置决定是否使用原价API
4. 原价API开关：当用户无可用套餐时，默认开启；用户可在套餐有效期内手动关闭

### 3.2 按量套餐包规则

| 规则项 | 说明 |
|--------|------|
| 购买数量上限 | 最多持有10个按量包（可相同或不同） |
| 有效期 | 自购买日起1年 |
| 扣费顺序 | 按**最先到期**的优先扣除 |
| 过期处理 | 过期未使用额度自动清零 |

### 3.3 包月套餐规则

| 规则项 | 说明 |
|--------|------|
| 档位限制 | 目前仅支持一种档位（99元） |
| 相同档位叠加 | 购买相同档位包月，**时长叠加** |
| 不同档位叠加 | 购买不同档位包月，**额度叠加** |
| 额度发放 | 每5小时固定发放一定积分 |
| 扣费优先级 | 先扣除价格较低的包月套餐 |

**示例说明**：
> 用户购买：2个19.9元包月 + 1个49.9元包月
> 
> 结果：
> - 2个月的19.9元套餐（时长叠加）
> - 1个月的49.9元套餐
> - 扣费顺序：先扣19.9元的每日额度，用尽后再扣49.9元的

### 3.4 混合套餐扣费规则

当用户同时持有包月和按量套餐时：
1. **优先扣除包月套餐**
2. 包月额度用尽后，**再扣除按量套餐**

---

## 4. 退款规则

### 4.1 包月套餐退款

```
退款金额 = (剩余天数 / 总天数) × 套餐价格 × 0.8
```

**规则说明**：
- 按剩余天数比例计算
- 退款系数为80%
- **当天已使用不退款**（即购买当天发起退款，不包含当天）

### 4.2 按量套餐退款

```
退款金额 = (剩余积分 / 总积分) × 套餐价格 × 0.8
```

**规则说明**：
- 按剩余积分比例计算
- 退款系数为80%

### 4.3 退款示例

| 场景 | 套餐价格 | 使用情况 | 退款金额 |
|------|----------|----------|----------|
| 包月套餐（30天） | 99元 | 已使用10天 | (20/30) × 99 × 0.8 = 52.8元 |
| 按量套餐 | 50元 | 已使用40%积分 | (60/100) × 50 × 0.8 = 24元 |

---

## 5. 积分计费系统

### 5.1 统一积分体系

所有套餐统一使用**套餐积分**作为计费单位。

在【套餐统计】页面，分类展示：
- Token 使用量
- 图片张数
- 像素数量
- 其他资源使用

最终统一换算为**额度积分**进行结算。

### 5.2 积分计费公式

```
积分结算 = 输入Token × 输入倍率 
         + 缓存创建Token × 缓存创建倍率 
         + 缓存命中Token × 缓存命中倍率 
         + 输出Token × 输出倍率
```

### 5.3 倍率说明表

| 可用模型 | 输入倍率 | 缓存创建倍率 | 缓存命中倍率 | 输出倍率 |
|----------|----------|--------------|--------------|----------|
| 模型A（待定） | - | - | - | - |
| 模型B（待定） | - | - | - | - |
| 模型C（待定） | - | - | - | - |

> 注：具体模型及倍率根据权限位展示，由后端询价接口返回

---

## 6. 套餐元数据结构

### 6.1 数据字段定义

| 字段名 | 字段说明 | 是否展示 | 示例 |
|--------|----------|----------|------|
| `package_id` | 套餐ID | 隐藏 | `pkg_001` |
| `package_name` | 套餐名称 | 展示 | "Clawdbot体验套餐 19.9元" |
| `package_type` | 套餐类型 | 展示 | `monthly` / `quota` |
| `price` | 套餐价格 | 展示 | 由询价接口返回 |
| `available_models` | 可用模型及倍率 | 点击查看 | 见倍率说明表 |
| `description` | 套餐描述 | 展示 | 数组，每行一条 |
| `validity_period` | 有效期 | 展示 | 包月30天/按量365天 |
| `credits_total` | 总积分额度 | 展示 | 10000 |

### 6.2 套餐名称规范

套餐命名需与 CC 和 Renkun 沟通确定，参考格式：
- **体验套餐**：Clawdbot体验套餐 19.9元
- **畅享套餐**：Clawdbot畅享套餐 99.9元
- **包月套餐**：Clawdbot包月套餐 99元

---

## 7. 页面功能设计

### 7.1 套餐购买页面

#### 7.1.1 页面元素
- 套餐列表卡片展示（体验包、包月、按量分区展示）
- 套餐名称、价格、描述
- 【套餐积分扣除说明】按钮
- **【原价API】开启按钮**（默认开启）
- **【免责说明】文案区域**
- **【规则说明】入口**

#### 7.1.2 原价API开关

| 配置项 | 说明 |
|--------|------|
| 位置 | 套餐购买页面显著位置 |
| 默认状态 | **开启** |
| 功能说明 | 当套餐额度用尽后，是否自动使用原价API继续服务 |
| 交互方式 | 开关按钮，点击切换状态 |

#### 7.1.3 免责说明

**展示位置**：套餐购买页面底部或购买确认弹窗

**内容要点**（参考其他厂商）：
- 套餐积分不可转让、不可提现
- 套餐有效期说明及过期清零提示
- 退款规则说明及扣除比例
- 服务可用性声明
- 价格调整权利声明
- 其他免责条款

#### 7.1.4 规则说明

**展示方式**：点击【规则说明】链接，弹出规则说明弹窗

**内容要点**：
- 套餐扣费优先级说明
- 套餐叠加规则说明
- 套餐有效期规则
- 退款规则详情
- 常见问题解答

#### 7.1.5 积分扣除说明弹窗

**触发方式**：点击【套餐积分扣除说明】按钮

**弹窗内容**：
1. 计费说明文案
2. 可用模型倍率表格
3. 根据用户权限位动态展示对应模型及倍率

### 7.2 套餐统计页面

#### 7.2.1 页面布局

```
┌─────────────────────────────────────────────┐
│  当前开通的套餐（不按生效状态排序）            │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐        │
│  │ 套餐1   │ │ 套餐2   │ │ 套餐3   │        │
│  │ (生效中)│ │ (生效中)│ │ (已失效)│        │
│  └─────────┘ └─────────┘ └─────────┘        │
├─────────────────────────────────────────────┤
│  使用记录表格                                │
│  ┌─────────────────────────────────────────┐│
│  │ 时间 │ 模型 │ APIKEY │ 套餐ID │ ... │▼ ││
│  ├─────────────────────────────────────────┤│
│  │ 记录1                              │ ▶ ││
│  │   └── 明细展开区域                      ││
│  │ 记录2                              │ ▶ ││
│  └─────────────────────────────────────────┘│
│  < 1 2 3 ... > 分页控件                     │
└─────────────────────────────────────────────┘
```

#### 7.2.2 套餐卡片展示规则

| 展示项 | 说明 |
|--------|------|
| 展示范围 | 展示用户所有套餐，**包括已失效套餐** |
| 排序规则 | 不按生效状态排序，按购买时间或套餐类型排列 |
| 状态标识 | 明确标注"生效中"、"已失效"、"即将到期"等状态 |
| 失效套餐 | 使用灰色或半透明样式区分，保留历史记录查看 |

**套餐卡片排列设计**：由 **小小（姜薇）** 和 **宋博瀚** 共同负责

#### 7.2.3 表格字段

| 列名 | 说明 |
|------|------|
| 时间 | 使用时间戳 |
| 模型 | 调用的模型名称 |
| APIKEY | 使用的API Key（脱敏展示） |
| 使用套餐ID | 扣费的套餐ID |
| 输入Token | 输入Token数量 |
| 输出Token | 输出Token数量 |
| 缓存创建 | 缓存创建Token数量 |
| 缓存读取 | 缓存命中Token数量 |
| 额度使用 | 本次消耗的积分 |
| 详情/展开 | 点击展开查看明细 |

#### 7.2.4 明细展开功能

**交互方式**：点击记录行的展开按钮（▶）或【详情】链接

**展开内容**：
| 明细项 | 说明 |
|--------|------|
| 倍率计算公式 | 显示本次调用的完整倍率计算过程 |
| 输入倍率 | 本次使用的输入倍率值 |
| 输出倍率 | 本次使用的输出倍率值 |
| 缓存创建倍率 | 本次使用的缓存创建倍率值 |
| 缓存命中倍率 | 本次使用的缓存命中倍率值 |
| 积分计算明细 | 各项Token × 对应倍率 = 各项积分，汇总显示 |

**展开样式**：
- 折叠状态：仅显示主要字段
- 展开状态：在当前行下方展开明细区域
- 支持单行展开或多行同时展开

#### 7.2.5 分页规则

- **后端分页**：使用 `Limit` 和 `Offset` 参数
- **每页条数**：10条
- **排序**：按时间倒序

### 7.3 模型广场页面

#### 7.3.1 套餐标注需求

在模型广场的模型卡片上，需要**标注该模型可使用的套餐类型**。

**展示规则**：

| 标注项 | 说明 |
|--------|------|
| 标注位置 | 模型卡片显著位置（角标/标签形式） |
| 标注内容 | 显示该模型支持的套餐类型（体验包/包月/按量） |
| 多套餐支持 | 如模型支持多种套餐，可显示多个标签 |
| 无套餐支持 | 仅支持原价API的模型，标注"仅原价"或不显示套餐标签 |

**标签样式示例**：
```
┌────────────────────────┐
│  [体验包] [包月]       │
│  Claude 3.5 Sonnet     │
│  ────────────────────  │
│  模型描述信息...        │
└────────────────────────┘
```

#### 7.3.2 交互设计

- 点击套餐标签可跳转至对应套餐购买页面
- 鼠标悬停显示该套餐的简要说明（Tooltip）

---

## 8. 接口需求

### 8.1 接口列表

| 接口名称 | 方法 | 说明 |
|----------|------|------|
| 获取套餐列表 | GET | 返回可购买的套餐列表及价格 |
| 购买套餐 | POST | 用户购买套餐 |
| 获取用户套餐 | GET | 获取用户当前持有的套餐 |
| 套餐使用记录 | GET | 分页获取套餐使用明细 |
| 申请退款 | POST | 用户发起套餐退款 |
| 原价API开关 | PUT | 设置原价API开关状态 |

### 8.2 关键接口参数

#### 套餐使用记录接口

**请求参数**：
```json
{
  "limit": 10,
  "offset": 0,
  "start_time": "2026-01-01T00:00:00Z",
  "end_time": "2026-02-01T00:00:00Z"
}
```

**响应参数**：
```json
{
  "total": 100,
  "data": [
    {
      "time": "2026-02-03T10:00:00Z",
      "model": "claude-3.5-sonnet",
      "api_key": "sk-****1234",
      "package_id": "pkg_001",
      "input_tokens": 1000,
      "output_tokens": 500,
      "cache_creation_tokens": 200,
      "cache_hit_tokens": 100,
      "credits_used": 150,
      "detail": {
        "input_rate": 1.0,
        "output_rate": 2.0,
        "cache_creation_rate": 1.5,
        "cache_hit_rate": 0.5
      }
    }
  ]
}
```

---

## 9. 待确认事项

| 序号 | 事项 | 负责人 | 状态 |
|------|------|--------|------|
| 1 | 套餐名称最终确定 | CC、Renkun | 待定 |
| 2 | 体验套餐定价 | 产品 | 待定 |
| 3 | 大套餐定价 | 产品 | 待定 |
| 4 | 可用模型清单及倍率 | 后端 | 待定 |
| 5 | 包月每5小时发放积分数量 | 产品 | 待定 |
| 6 | 套餐卡片排列设计 | 小小（姜薇）、宋博瀚 | 待定 |
| 7 | 免责说明文案 | 法务/产品 | 待定 |
| 8 | 规则说明文案 | 产品 | 待定 |
| 9 | 模型广场套餐标签设计 | 设计 | 待定 |

---

## 10. 上线计划

### 10.1 MVP（最小可行产品）

**首期上线内容**：
- [ ] 99元包月套餐
- [ ] 体验包套餐
- [ ] 大额按量套餐
- [ ] 套餐购买页面（含免责说明、规则说明、原价API开关）
- [ ] 套餐统计页面（含明细展开、失效套餐展示）
- [ ] 模型广场套餐标注
- [ ] 基础退款功能

### 10.2 后续迭代

- [ ] 多档位包月套餐
- [ ] 套餐优惠活动支持
- [ ] 套餐续费提醒
- [ ] 自动续费功能

---

## 附录

### A. 术语表

| 术语 | 说明 |
|------|------|
| 套餐积分 | 统一的计费单位 |
| 包月 | 按月订阅的套餐类型 |
| 按量 | 一次性购买、用完即止的套餐类型 |
| 倍率 | Token转换为积分的换算比例 |
| 权限位 | 用户可使用的模型权限标识 |

### B. 修订记录

| 版本 | 日期 | 修订内容 | 修订人 |
|------|------|----------|--------|
| V1.0 | 2026-02-03 | 初稿 | - |
| V1.1 | 2026-02-03 | 补充功能需求：免责说明、规则说明、原价API开关、明细展开、失效套餐展示、模型广场套餐标注 | - |
